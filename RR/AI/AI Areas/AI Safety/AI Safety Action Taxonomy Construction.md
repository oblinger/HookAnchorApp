


let me describe a new functionality for hook anchor called history. Will put this in a module. It's also called history. And this system maintains a set of markdown files that express the history of changes to the markdown themselves.
- the system scans the markdown files underneath the vault and looks for changes to the files or new files, and when it finds these it scans, it looks at the folder that the file that the markdown file was in and sees which anchor this is associated with. If it's not associated with an anchor, then it goes to the parent folder and see if that's associate with an anchor and it continues this until it finds an anchor that it's associated with. Once this is found, it's gonna add this change to all containing anchors that have a history. If it gets to the root of the vault and it's not found an anchor with the history, then no further processing is done on that fi on that file.
- an anchor has a history associated with it, if there's a markdown file who is suffix ends with history case and sensitive. So to track this, we actually add a field to the patch struct to keep track of the history marked down associated with that patch. When we identify a new.
- when we identify a new file or changed file, we added an entry to all relevant history files. The containing anchor with the history is the first history files updated but then we find a Parent patch for this patch and we check to see if it has a history entry, and if it does, then we update that history as well. And we continue this going to the Parent for each patch all the way up until we get to the root of the patch, DAG. All of us histories will be updated.
- his histories are maintained in reverse chronological order. So when we find new entries, we put them in reverse chronological order. Each entry is going to be on its own line, and we all of these lines to the existing history file.
- the system has a flag, indicating whether it's rebuilding histories from scratch, if rebuild is true, then it doesn't pay attention to the current contents of the history file and it rewrite them. Otherwise it's just pretending to the existing history file.
- the system maintains a history, cash, in the config folder. This history, cash tracks the list of all markdown files the size of those files in bites and the modification time for the file. So the system will scan all marked down files, looking for changes in the modification time. This cash is Index. It's addicted in Memory. It is. It is a hash map in memory Index by the path of the file and key in it returns the modification time and size.
- any time a new file is found that will be captured as a new entry, and for any anchor file, will any file that has a patch struck, that has modified will be scanned and if we find a line beginning with "# Log" case sensitive, then any new entries which are each one or H2 tags are also viewed as new entries. There should be a special section in the config file which configures all of this, the new section is called history and underneath it, it will have anchor log indicator, which is set to be the string it's looking for. And then anchor levels will be sent to be set to actually be set to a list containing one and two this indicates that any each tag of depth one or two will be treated as a new entry.
- for all of these new entries we're gonna have a single line to all of the relevant history files. The line begins. YYYY-MM-DD with the date of the modification itself, then there will be a wiki link to the file itself, or a link to the H tag within the file. The wiki link's name should be just the base name of the file. And if this is an entry that just points to a file, that's the end of the entry. If this entry is in each tag with the file and each tag the letter H tag within the file then it should be followed by the contents after the H tag,. No let me update this if the entry is for a whole file then it begins with a date, followed by the wiki link to the file itself. That's it if it's not a file if it's. Let me start again.
- OK, let me describe this again, if an entry represents a whole file, then it will begin with the date as described, followed by a wiki link to the file itself with one tab character after the date and before the wiki link.
- if the entry represents an H tag within the file, then we purse the title of that H tag and see if it begins with a date in that format. If it does, then we use that date for this entry, followed by a tab, followed by a weekly link to the file and the H entry in the file, in the visible text for this link is just the name of the file, then there's a tab and after the tab character, we put the rest of the H tag line after the date if there was a date on this entry in the history.
- in both cases, the same history line is added to all relevant histories. So we can compute the line for each file and then add it to all of the histories.
- we should keep a hash nap for someday to structure of all the histories that have been updated by the scanning process. The list of lines being added to each one is maintained. At the end of processing, we should sort the new entries in reverse, chronological order, and then pretend this list pre-penned this list to the contents of those histories before the scan began. Unless we're building this from scratch in which case we merely use the existence of a history to indicate that that history should be updated, but we otherwise discard the contents of that history when we're doing rebuild all. The rebuild All flag should be passed in from the route call to this.
- let's design the history module, you can add to our design docs, a history doc that specifies the design that we're gonna do please annotate every function that you're gonna create and every day to every key day structure you're going to use as well as the configuration file variables that you're gonna add let's look at this and agree on it before you begin. If you have any questions about the way that this should be implemented or the way this should operate. Please ask me.
- 




```
click link [[here]]  
```

	foo [[here]]  
	